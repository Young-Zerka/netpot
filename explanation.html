<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Netpot - Code Explanation</title>
<link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="netpot.png">
</head>
<body>
<header>Netpot</header>
<nav>
<a href="index.html">Home</a>
<a href="explanation.html">Code Explanation</a>
<a href="download.html">Download</a>
<a href="about.html">About</a>
</nav>
<main>
<h1>Code Explanation</h1>
<p>The Netpot batch script is structured as a command-line menu system:</p>
<ul>
<li>Requests administrative privileges for registry and network commands.</li>
<li>Changes CMD font to Consolas for better readability.</li>
<li>Main menu options:
  <ul>
    <li>IP information (ipconfig)</li>
    <li>Network status (netstat)</li>
    <li>Wi-Fi info and management (netsh)</li>
    <li>Network configuration (ARP, hostname, systeminfo)</li>
    <li>Connections and sharing (net use, net view, net share)</li>
    <li>Extras: ping, tracert, pathping, nslookup</li>
    <li>Help and exit</li>
  </ul>
</li>
<li>Submenus allow running specific commands and display a ‚ÄúFinished‚Äù message in green after completion.</li>
<li>Includes Wi-Fi detection and appropriate handling if Wi-Fi is not supported.</li>
</ul>
<pre>
@echo off
cd /d "%~dp0"

net session >nul 2>&1
if %errorlevel% neq 0 (
    echo Requesting administrative privileges...
    powershell -Command "Start-Process cmd -ArgumentList '/c cd /d %~dp0 && %~nx0' -Verb RunAs"
    timeout /t 1 /nobreak >nul
    exit
)

setlocal enabledelayedexpansion
setlocal ENABLEDELAYEDEXPANSION
chcp 65001 >nul
chcp 437 >nul

chcp 65001 >nul
chcp 437 >nul
reg add "HKCU\Console" /v FaceName /t REG_SZ /d "Consolas" /f >nul
reg add "HKCU\Console" /v FontFamily /t REG_DWORD /d 0x36 /f >nul
reg add "HKCU\Console" /v FontSize /t REG_DWORD /d 0x00120000 /f >nul
title Netpot
goto main

:exitScript
cls
color 07
echo.
echo                Thank you for using Netpot!
echo                Closing...
timeout /t 2 /nobreak >nul
exit /b

:SetScrollableWindow
mode con: cols=125 lines=50
powershell -command "&{$h=get-host;$w=$h.ui.rawui;$s=$w.buffersize;$s.height=5000;$w.buffersize=$s;}"
exit /b

:RunCommand
call :SetScrollableWindow
%*
echo.
powershell -NoProfile -Command "Write-Host 'Command completed.' -ForegroundColor Green"
pause >nul
goto %return_menu%

:main
mode con: cols=76 lines=25
cls
echo.
echo.
echo                    Inspired by [32mMassgrave[0m, made by [32mNoctua[0m
echo            ______________________________________________________
echo.
echo                    Check your network:
echo.
echo                [1] ipconfig    - IP information
echo                [2] netstat     - Active network connections
echo                [3] netsh       - Wi-Fi information
echo                [4] Network Configuration + Information
echo                [5] Network Connections / Sharing
echo                ____________________________________________
echo.
echo                [6] Extras
echo                [7] Help
echo                [0] Exit
echo            ______________________________________________________
echo.
set /p choice=[32m       Enter a menu option in the keyboard [1, 2, 3, 4, 5, 6, 7, 0]: [0m
if "%choice%"=="1" goto ipconfig_menu
if "%choice%"=="2" goto netstat_menu
if "%choice%"=="3" goto check_wifi
if "%choice%"=="4" goto netconf_menu
if "%choice%"=="5" goto netconn_menu
if "%choice%"=="6" goto extras
if "%choice%"=="7" goto help
if "%choice%"=="0" exit
goto main

:check_wifi
sc query wlansvc | find "RUNNING" >nul
if not %errorlevel%==0 goto no_wifi
netsh wlan show drivers | find "Wireless" >nul
if not %errorlevel%==0 goto no_wifi
goto netsh_menu

:no_wifi
cls
echo.
echo.
echo            _______________________________________________
echo.
echo                Your PC doesn't support Wi-Fi yet.
echo            _______________________________________________
echo.
pause>nul
goto main

:ipconfig_menu
mode con: cols=76 lines=19
cls
echo.
echo.
echo            __________________________________________________________
echo.
echo                [2] /all          - Show detailed IP configuration
echo                [3] /release      - Release current IP address
echo                [4] /renew        - Renew IP address from DHCP
echo                [5] /flushdns     - Clear DNS cache
echo                [6] /displaydns   - View DNS cache
echo                __________________________________________________
echo.
echo                [1] Back
echo                [0] Exit
echo            __________________________________________________________
echo.
set /p subchoice=[32m           Enter a menu option in the keyboard [1, 2, 3, 4, 5, 6, 0]: [0m
if "%subchoice%"=="2" set "return_menu=ipconfig_menu" & call :RunCommand ipconfig /all
if "%subchoice%"=="3" set "return_menu=ipconfig_menu" & call :RunCommand ipconfig /release
if "%subchoice%"=="4" set "return_menu=ipconfig_menu" & call :RunCommand ipconfig /renew
if "%subchoice%"=="5" cls & ipconfig /flushdns & powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green" & pause>nul & goto ipconfig_menu
if "%subchoice%"=="6" cls & ipconfig /displaydns & powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green" & pause>nul & goto ipconfig_menu
if "%subchoice%"=="1" goto main
if "%subchoice%"=="0" goto exitScript
goto ipconfig_menu

:netstat_menu
mode con: cols=76 lines=19
cls
echo.
echo.
echo            ___________________________________________________________
echo.
echo                [2] netstat     - Show active network connections
echo                [3] -ano        - Show connections with process IDs
echo                [4] -b          - Show which apps use which ports
echo                [5] -r          - Show routing table
echo                [6] -e          - Show Ethernet stats
echo                ___________________________________________________
echo.
echo                [1] Back
echo                [0] Exit
echo            ___________________________________________________________
echo.
set /p subchoice=[32m           Enter a menu option in the keyboard [1, 2, 3, 4, 5, 6, 0]: [0m
if "%subchoice%"=="2" cls & netstat & powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green" & pause>nul & goto netstat_menu
if "%subchoice%"=="3" cls & netstat -ano & powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green" & pause>nul & goto netstat_menu
if "%subchoice%"=="4" cls & netstat -b & powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green" & pause>nul & goto netstat_menu
if "%subchoice%"=="5" cls & netstat -r & powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green" & pause>nul & goto netstat_menu
if "%subchoice%"=="6" cls & netstat -e & powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green" & pause>nul & goto netstat_menu
if "%subchoice%"=="1" goto main
if "%subchoice%"=="0" goto exitScript
goto netstat_menu

:netsh_menu
mode con: cols=105 lines=27
cls
echo.
echo.
echo            __________________________________________________________________________________
echo.
echo                [2] Scan for Wi-Fi Networks       - Show available wireless networks
echo                [3] Show Saved Networks          - List all saved Wi-Fi profiles
echo                [4] View Wi-Fi Password          - Show password for a saved network
echo                [5] Connection Details           - Show current Wi-Fi status
echo                [6] Enable/Disable Wi-Fi         - Toggle wireless adapter
echo                [7] Network Reset                - Reset all network settings
echo                ___________________________________________________________________________
echo.
echo                [1] Back
echo                [0] Exit
echo            __________________________________________________________________________________
echo.
set /p subchoice=[32m           Enter a menu option in the keyboard [1, 2, 3, 4, 5, 6, 0]: [0m
if "%subchoice%"=="2" (
    set "return_menu=netsh_menu"
    echo Scanning for wireless networks...
    echo.
    call :RunCommand netsh wlan show networks mode=bssid
)
if "%subchoice%"=="3" (
    mode con: cols=125 lines=25
    cls
    echo List of saved Wi-Fi profiles:
    echo.
    netsh wlan show profiles
    echo.
    powershell -NoProfile -Command "Write-Host 'All saved networks listed above.' -ForegroundColor Green"
    pause >nul
    goto netsh_menu
)

if "%subchoice%"=="4" (
    call :SetScrollableWindow
    mode con: cols=125 lines=25
    cls
    echo Available profiles:
    netsh wlan show profiles
    echo.
    set /p "profile=Enter the exact profile name: "
    cls
    call :SetScrollableWindow
    echo Getting password for profile: !profile!
    echo.
    netsh wlan show profile name="!profile!" key=clear
    echo.
    powershell -NoProfile -Command "Write-Host 'Password info shown above (if available).' -ForegroundColor Green"
    pause >nul
    endlocal & goto netsh_menu
)

if "%subchoice%"=="5" (
    mode con: cols=125 lines=25
    cls
    echo Current Wi-Fi Connection Status:
    echo =============================
    echo.
    netsh wlan show interfaces
    echo.
    echo Detailed Connection Information:
    echo ============================
    netsh wlan show interface mode=ssid
    echo.
    powershell -NoProfile -Command "Write-Host 'Connection details shown above.' -ForegroundColor Green"
    pause >nul
    goto netsh_menu
)
if "%subchoice%"=="6" (
    mode con: cols=125 lines=25
    cls
    echo Current Wi-Fi status:
    netsh interface show interface name="Wi-Fi"
    echo.
    set /p "toggle=Type 'enable' or 'disable' to toggle Wi-Fi: "
    if /i "%toggle%"=="enable" (
        netsh interface set interface name="Wi-Fi" admin=enabled
        echo.
        powershell -NoProfile -Command "Write-Host 'Wi-Fi has been enabled.' -ForegroundColor Green"
    ) else if /i "%toggle%"=="disable" (
        netsh interface set interface name="Wi-Fi" admin=disabled
        echo.
        powershell -NoProfile -Command "Write-Host 'Wi-Fi has been disabled.' -ForegroundColor Yellow"
    )
    pause >nul
    goto netsh_menu
)
if "%subchoice%"=="7" (
    mode con: cols=125 lines=25
    cls
    echo Resetting network configuration...
    echo.
    netsh int ip reset
    netsh winsock reset
    netsh advfirewall reset
    ipconfig /release
    ipconfig /renew
    ipconfig /flushdns
    echo.
    powershell -NoProfile -Command "Write-Host 'Network settings have been reset. A restart is recommended.' -ForegroundColor Yellow"
    pause >nul
    goto netsh_menu
)
if "%subchoice%"=="1" goto main
if "%subchoice%"=="0" goto main
goto netsh_menu

:netconf_menu
mode con: cols=115 lines=22
cls
echo.
echo.
echo            _____________________________________________________________________________________________
echo.
echo                [2] arp -a                                          - Show ARP table
echo                [3] getmac                                          - Display MAC addresses
echo                [4] hostname                                        - Show your computer‚Äôs hostname
echo                [5] route print                                     - Show routing table entries
echo                [6] nbtstat -n                                      - Show NetBIOS name table
echo                [7] systeminfo                                      - Display full system info
echo                [8] wmic nic get name,macaddress                    - Show network adapters and MACs
echo                [9] wmic nicconfig get ipaddress,description        - Show adapter IP info           
echo                _____________________________________________________________________________________
echo.
echo                [1] Back
echo                [0] Exit
echo            _____________________________________________________________________________________________
echo.
set /p subchoice=[32m           Enter a menu option in the keyboard [1, 2, 3, 4, 5, 6, 7, 8, 9, 0]: [0m
if "%subchoice%"=="2" (
    mode con: cols=125 lines=25
    cls
    arp -a
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconf_menu
)
if "%subchoice%"=="3" (
    mode con: cols=125 lines=25
    cls
    getmac
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconf_menu
)
if "%subchoice%"=="4" (
    mode con: cols=125 lines=25
    cls
    hostname   
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconf_menu
)
if "%subchoice%"=="5" (
    mode con: cols=125 lines=25
    cls
    route print   
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconf_menu
)
if "%subchoice%"=="6" (
    mode con: cols=125 lines=25
    cls
    nbtstat -n   
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconf_menu
)
if "%subchoice%"=="7" (
    mode con: cols=125 lines=25
    cls
    systeminfo    
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconf_menu
)
if "%subchoice%"=="8" (
    mode con: cols=125 lines=25
    cls
    wmic nic get name,macaddress 
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconf_menu
)
if "%subchoice%"=="9" (
    mode con: cols=125 lines=25
    cls
    wmic nicconfig get ipaddress,description
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconf_menu
)
if "%subchoice%"=="1" goto main
if "%subchoice%"=="0" goto main
goto netconf_menu

:netconn_menu
mode con: cols=86 lines=18
cls
echo.
echo.
echo            _________________________________________________________________
echo.
echo                [2] net use         - Connect to shared network resources
echo                [3] net view        - Show available network computers
echo                [4] net share       - Show shared folders on your system 
echo                _________________________________________________________
echo.
echo                [1] Back
echo                [0] Exit
echo            _________________________________________________________________
echo.
set /p subchoice=[32m           Enter a menu option in the keyboard [1, 2, 3, 0]: [0m
if "%subchoice%"=="2" (
    mode con: cols=125 lines=25
    cls
    net use
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconn_menu
)
if "%subchoice%"=="3" (
    mode con: cols=125 lines=25
    cls
    net view 
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconn_menu
)
if "%subchoice%"=="4" (
    mode con: cols=125 lines=25
    cls
    net share 
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto netconn_menu
)
if "%subchoice%"=="1" goto main
if "%subchoice%"=="0" goto main
goto netconn_menu

:extras
mode con: cols=89 lines=20  
cls
echo.
echo.
echo            ____________________________________________________________________
echo.
echo                    Extras:
echo.
echo                [2] ping (host)             - Test connectivity to a host
echo                [3] tracert (host)          - Trace route to a host
echo                [4] pathping (host)         - Trace and analyze network path
echo                [5] nslookup (domain)       - Get DNS info for a domain     
echo                ____________________________________________________________
echo.
echo                [1] Back
echo                [0] Exit
echo            ____________________________________________________________________
echo.
set /p subchoice=[32m           Enter a menu option in the keyboard [1, 2, 3, 4, 5, 0]: [0m
if "%subchoice%"=="2" (
    mode con: cols=125 lines=25
    cls
    echo [Ping]
    set /p host=Enter host: 
    ping %host%
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto extras
)

if "%subchoice%"=="3" (
    mode con: cols=125 lines=25
    cls
    echo [Tracert]
    set /p host=Enter host: 
    tracert %host%
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto extras
)

if "%subchoice%"=="4" (
    mode con: cols=125 lines=25
    cls
    echo [Pathping]
    set /p host=Enter host: 
    pathping %host%
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto extras
)

if "%subchoice%"=="5" (
    mode con: cols=125 lines=25
    cls
    echo [Nslookup]
    set /p domain=Enter host: 
    nslookup %domain%
    echo.
    powershell -NoProfile -Command "Write-Host 'Finished.' -ForegroundColor Green"
    pause >nul
    goto extras
)
if "%subchoice%"=="1" goto main
if "%subchoice%"=="0" goto main
goto extras

:help
mode con: cols=95 lines=20
cls
echo.
echo.
echo            _________________________________________________________________
echo.
echo                    Help - Network Tool Overview:
echo.
echo                [1] IP Commands            - ipconfig related options
echo                [2] Network Status         - netstat related options
echo                [3] Wi-Fi Commands         - netsh related Wi-Fi info
echo                [4] Network Configuration  - arp, getmac, hostname, systeminfo
echo                [5] Connections/Sharing    - net use, net view, net share
echo                [6] Extras                 - ping, tracert, pathping, nslookup
echo                _________________________________________________________________
echo.
echo                [0] Back to Main Menu
echo            _________________________________________________________________
echo.
set /p subchoice=[32m           Enter a menu option [1, 2, 3, 4, 5, 6, 0]: [0m
if "%subchoice%"=="1" goto ipconfig_menu
if "%subchoice%"=="2" goto netstat_menu
if "%subchoice%"=="3" goto netsh_menu
if "%subchoice%"=="4" goto netconf_menu
if "%subchoice%"=="5" goto netconn_menu
if "%subchoice%"=="6" goto extras
if "%subchoice%"=="0" goto main
goto help
</pre>
</main>
<footer>&copy; 2025 Noctua</footer>
</body>
</html>
